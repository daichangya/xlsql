<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>使用指南 - XLSQL</title>
    <meta name="description" content="XLSQL 使用文档，包括依赖配置、JDBC 连接示例、配置说明和常见问题解答。">
    <link href="https://cdnjs.loli.net/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html"><i class="fas fa-database me-2"></i>XLSQL</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">首页</a></li>
                    <li class="nav-item"><a class="nav-link active" href="usage.html">使用指南</a></li>
                    <li class="nav-item"><a class="nav-link" href="download.html">下载安装</a></li>
                    <li class="nav-item"><a class="nav-link" href="community.html">社区</a></li>
                    <li class="nav-item"><a class="nav-link" href="https://github.com/daichangya/xlsql" target="_blank"><i class="fab fa-github"></i> GitHub</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-5 pt-5">
        <div class="row">
            <!-- Sidebar Navigation -->
            <div class="col-lg-3 d-none d-lg-block">
                <nav class="docs-nav bg-light p-3 rounded">
                    <h5 class="mb-3">目录</h5>
                    <nav class="nav flex-column">
                        <a class="nav-link" href="#quick-start">快速开始</a>
                        <a class="nav-link" href="#dependency">依赖配置</a>
                        <a class="nav-link" href="#jdbc-usage">JDBC 使用</a>
                        <a class="nav-link" href="#configuration">配置说明</a>
                        <a class="nav-link" href="#troubleshooting">常见问题</a>
                    </nav>
                </nav>
            </div>

            <!-- Content Area -->
            <div class="col-lg-9">
                <h1 class="mb-4">使用指南</h1>

                <section id="quick-start" class="mb-5">
                    <h2>快速开始</h2>
                    <p>XLSQL 允许您像操作数据库一样操作 Excel 文件。只需几个简单的步骤即可集成到您的 Java 项目中。</p>
                </section>

                <section id="dependency" class="mb-5">
                    <h3>依赖配置</h3>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>XLSQL 5.1.0 已发布到 Maven Central</strong>，您可以直接通过 Maven 依赖使用。
                    </div>
                    <p>在您的 <code>pom.xml</code> 中添加以下依赖：</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.jsdiff&lt;/groupId&gt;
    &lt;artifactId&gt;xlsql&lt;/artifactId&gt;
    &lt;version&gt;5.1.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
                    <p class="mt-2">
                        <a href="https://search.maven.org/artifact/com.jsdiff/xlsql" target="_blank" class="btn btn-sm btn-outline-primary">
                            <i class="fas fa-external-link-alt me-2"></i>在 Maven Central 查看
                        </a>
                    </p>
                </section>

                <section id="jdbc-usage" class="mb-5">
                    <h3>JDBC 使用示例</h3>
                    <p>XLSQL 完全遵循 JDBC 标准，以下是一个完整的查询示例：</p>
<pre><code class="language-java">import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class ExcelQuery {
    public static void main(String[] args) throws Exception {
        // 1. 注册驱动
        Class.forName("com.jsdiff.xlsql.jdbc.xlDriver");

        // 2. 创建连接
        // URL 格式: jdbc:xlsql:excel:/path/to/directory
        String url = "jdbc:xlsql:excel:/data/excel_files";
        try (Connection conn = DriverManager.getConnection(url);
             Statement stmt = conn.createStatement()) {
            
            // 3. 执行查询
            // 表名格式: "文件名.工作表名" (注意引号)
            String sql = "SELECT * FROM sales_2024_Sheet1 WHERE amount > 1000";
            try (ResultSet rs = stmt.executeQuery(sql)) {
                while (rs.next()) {
                    System.out.println("Customer: " + rs.getString("Customer"));
                    System.out.println("Amount: " + rs.getDouble("Amount"));
                }
            }
        }
    }
}</code></pre>
                </section>

                <section id="configuration" class="mb-5">
                    <h3>配置说明</h3>
                    <p>您可以通过环境变量或系统属性来配置 XLSQL。</p>
                    
                    <h4 class="mt-4">环境变量</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>变量名</th>
                                <th>描述</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>XLSQL_CONFIG_PATH</code></td>
                                <td>配置文件路径</td>
                            </tr>
                            <tr>
                                <td><code>XLSQL_LOG_PATH</code></td>
                                <td>日志文件路径</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4 class="mt-4">配置文件 (xlsql_config.properties)</h4>
                    <p>默认位置：<code>~/.xlsql/xlsql_config.properties</code></p>
<pre><code class="language-properties"># 数据库引擎 (hsqldb, h2 或 native)
engine=hsqldb

# HSQLDB 配置
hsqldb.url=jdbc:hsqldb:mem:xlsql
hsqldb.user=sa
hsqldb.password=

# H2 配置（可选）
h2.url=jdbc:h2:mem:xlsql
h2.user=sa
h2.password=</code></pre>
                </section>

                <section id="troubleshooting" class="mb-5">
                    <h3>常见问题</h3>
                    
                    <div class="accordion" id="faqAccordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                    1. 找不到类 ClassNotFoundException: xlDriver
                                </button>
                            </h2>
                            <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    <strong>解决：</strong> 确保 XLSQL JAR 包已正确添加到项目的 classpath 中。如果是 Maven 项目，请检查依赖是否下载成功。
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                    2. 连接失败 "Directory does not exist"
                                </button>
                            </h2>
                            <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    <strong>解决：</strong> 检查 JDBC URL 中的路径是否正确。确保该路径在文件系统中存在，且应用程序有读取权限。
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                    3. SQL 查询提示 "Table not found"
                                </button>
                            </h2>
                            <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    <strong>解决：</strong> 
                                    <ul>
                                        <li>确保 Excel 文件存在于连接的目录中。</li>
                                        <li>表名格式必须为 <code>"文件名.工作表名"</code>，例如 <code>"test_Sheet1"</code>。</li>
                                        <li>文件名不包含扩展名（.xls/.xlsx）。</li>
                                        <li>注意 SQL 中的引号和大小写敏感性。</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5>XLSQL</h5>
                    <p class="small">基于 Java 的 Excel SQL 引擎，让数据处理更简单。</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>链接</h5>
                    <ul class="list-unstyled">
                        <li><a href="https://github.com/daichangya/xlsql">GitHub 仓库</a></li>
                        <li><a href="https://blog.jsdiff.com/">官方博客</a></li>
                        <li><a href="https://github.com/daichangya/xlsql/issues">问题反馈</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>联系我们</h5>
                    <p class="small">关注微信公众号：Java码界探秘</p>
                </div>
            </div>
            <hr class="border-secondary">
            <p class="mb-0">&copy; <span id="current-year">2025</span> XLSQL Project. Released under GPL License.</p>
        </div>
    </footer>

    <script src="https://cdnjs.loli.net/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
</body>
</html>

